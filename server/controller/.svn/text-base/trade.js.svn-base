/**
 * Order Controller
 * @author W.G
 * @version 1.0
 */

'use strict';

var url = require('url');
var ctrlTrade = require('./ctrl_base').base;

/**
 * 所有客户的店铺转单一次
 * 1个主进程 负责任务调度 
 * 3个工作进程(根据business_id % 200 suffix来分配) 转单
 */

var moment = require('moment')
    , dispacher = require('../../app/models/dispacher');

ctrlTrade.transfer = function(res, req) {
    var params = url.parse(req.url, true).query;

    this.set_stream(res);
    this.html_head();   
    this.echo('Processing Transfer Trade Tasks....');
    this.end();
    
    var platform = params.platform;

    if (!platform) return ;

    dispacher.dispach_transfer_msg(platform);
};

exports.handler = ctrlTrade;
